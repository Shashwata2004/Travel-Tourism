<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.geometry.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.shape.Circle?>
<?import javafx.scene.shape.SVGPath?>
<?import javafx.collections.FXCollections?>
<?import java.lang.String?>

<StackPane xmlns="http://javafx.com/javafx"
           xmlns:fx="http://javafx.com/fxml"
           fx:controller="com.travel.frontend.controller.HotelSearchController"
           stylesheets="@/css/login.css,@/css/packages.css,@/css/destinations.css,@/css/hotel_search.css"
           styleClass="hotelRoot">

    <children>
        <!-- Background orbs -->
        <Pane styleClass="orbLayer">
            <children>
                <Circle centerX="180" centerY="160" radius="200" styleClass="orbA"/>
                <Circle centerX="1080" centerY="520" radius="220" styleClass="orbB"/>
                <Circle centerX="1240" centerY="280" radius="210" styleClass="orbC"/>
            </children>
        </Pane>

        <!-- Scrollable content -->
        <ScrollPane fitToWidth="true" hbarPolicy="NEVER" vbarPolicy="AS_NEEDED" styleClass="hotelScroll">
            <content>
                <StackPane fx:id="rootStack" maxWidth="Infinity">
                    <VBox spacing="14" fillWidth="true" styleClass="hotelContent">
                        <!-- Hero card -->
                        <StackPane styleClass="hotelHero">
                            <VBox alignment="CENTER" spacing="14" fillWidth="false">
                                <!-- Badge -->
                                <Label styleClass="heroBadge">
                                    <graphic>
                                        <HBox alignment="CENTER" spacing="8">
                                            <StackPane>
                                                <SVGPath styleClass="pinIcon"
                                                         content="M12 2c-3.3137 0-6 2.6863-6 6 0 4.5 6 10 6 10s6-5.5 6-10c0-3.3137-2.6863-6-6-6zm0 8.2c-1.215 0-2.2-.985-2.2-2.2 0-1.215.985-2.2 2.2-2.2 1.215 0 2.2.985 2.2 2.2 0 1.215-.985 2.2-2.2 2.2z"/>
                                                <Circle radius="2" styleClass="pinCenter"/>
                                            </StackPane>
                                            <Label fx:id="heroBadgeText"
                                                   text="Explore Bangladesh"
                                                   styleClass="heroBadgeText"/>
                                        </HBox>
                                    </graphic>
                                </Label>

                                <!-- Title & subtitle -->
                                <Label fx:id="heroTitle"
                                       text="Find Stays Youâ€™ll Love"
                                       styleClass="heroTitle"/>

                                <Label fx:id="heroSubtitle"
                                       text="From boutique resorts to hillside retreats, pick the perfect stay with just a few taps."
                                       wrapText="true"
                                       maxWidth="680"
                                       alignment="CENTER"
                                       textAlignment="CENTER"
                                       styleClass="heroSubtitle"/>

                                <!-- Search capsule -->
                                <HBox alignment="CENTER_LEFT"
                                      spacing="18"
                                      styleClass="searchCapsule">

                                    <!-- CHECK IN -->
                                    <VBox spacing="6"
                                          alignment="CENTER_LEFT"
                                          styleClass="searchPill">
                                        <Label text="CHECK IN" styleClass="pillLabel"/>
                                        <HBox alignment="CENTER_LEFT" spacing="6">
                                            <Label text="ðŸ“…" styleClass="pillIcon"/>
                                            <DatePicker fx:id="checkInPicker"
                                                        promptText="Select date"
                                                        editable="false"
                                                        styleClass="pillValue"/>
                                        </HBox>
                                    </VBox>

                                    <!-- CHECK OUT -->
                                    <VBox spacing="6"
                                          alignment="CENTER_LEFT"
                                          styleClass="searchPill">
                                        <Label text="CHECK OUT" styleClass="pillLabel"/>
                                        <HBox alignment="CENTER_LEFT" spacing="6">
                                            <Label text="ðŸ“…" styleClass="pillIcon"/>
                                            <DatePicker fx:id="checkOutPicker"
                                                        promptText="Select date"
                                                        editable="false"
                                                        styleClass="pillValue"/>
                                        </HBox>
                                    </VBox>

                                    <!-- TOTAL GUESTS -->
                                    <StackPane alignment="TOP_LEFT" pickOnBounds="false">
                                        <VBox spacing="6"
                                              alignment="CENTER_LEFT"
                                              styleClass="searchPill"
                                              onMouseClicked="#toggleGuests">
                                            <Label text="TOTAL GUESTS" styleClass="pillLabel"/>
                                            <HBox alignment="CENTER_LEFT" spacing="6">
                                                <SVGPath styleClass="guestIcon"
                                                         content="M8 3.5a3 3 0 1 1 0 6 3 3 0 0 1 0-6zm8 1.5a2.5 2.5 0 1 1 0 5 2.5 2.5 0 0 1 0-5zM8 11c-.59 0-1.17.08-1.71.23A6.87 6.87 0 0 0 1.5 16v2.5h9V16c0-.59.15-1.17.44-1.69A6.87 6.87 0 0 0 8 11zm5.54 1.16c-.37.16-.71.35-1.02.57-.36.25-.6.47-.74.61-.2.2-.3.33-.34.39-.07.1-.14.22-.18.34-.15.39-.24.81-.24 1.23V18.5H20V17c0-1.82-1.63-3.18-2.8-3.8a5.44 5.44 0 0 0-3.66-.99z"
                                                         fill="#0f172a"
                                                         scaleX="0.9"
                                                         scaleY="0.9" />
                                                <Label fx:id="guestValue"
                                                       text="2 Guests"
                                                       styleClass="pillValue"/>
                                            </HBox>
                                        </VBox>

                                        <!-- Inline guest overlay -->
                                        <StackPane fx:id="guestOverlay"
                                                   alignment="TOP_LEFT"
                                                   visible="false"
                                                   managed="false"
                                                   pickOnBounds="false"
                                                   styleClass="guestOverlayMini">
                                            <VBox fx:id="guestCard"
                                                  alignment="CENTER"
                                                  spacing="14"
                                                  styleClass="guestCardMini"
                                                  onMouseClicked="#consumeGuestCard">
                                                <HBox alignment="CENTER_LEFT" spacing="10">
                                                    <SVGPath styleClass="guestIcon"
                                                             content="M8 3.5a3 3 0 1 1 0 6 3 3 0 0 1 0-6zm8 1.5a2.5 2.5 0 1 1 0 5 2.5 2.5 0 0 1 0-5zM8 11c-.59 0-1.17.08-1.71.23A6.87 6.87 0 0 0 1.5 16v2.5h9V16c0-.59.15-1.17.44-1.69A6.87 6.87 0 0 0 8 11zm5.54 1.16c-.37.16-.71.35-1.02.57-.36.25-.6.47-.74.61-.2.2-.3.33-.34.39-.07.1-.14.22-.18.34-.15.39-.24.81-.24 1.23V18.5H20V17c0-1.82-1.63-3.18-2.8-3.8a5.44 5.44 0 0 0-3.66-.99z"
                                                             fill="#4338ca"
                                                             scaleX="0.9"
                                                             scaleY="0.9"/>
                                                    <Label text="Total Person" styleClass="pillLabel"/>
                                                </HBox>
                                                <HBox alignment="CENTER" spacing="18" styleClass="guestStepperMini">
                                                    <Button text="âˆ’"
                                                            onAction="#decrementGuests"
                                                            styleClass="roundBtnMini"/>
                                                    <Label fx:id="overlayGuestValue"
                                                           text="2"
                                                           styleClass="pillValue"/>
                                                    <Button text="+"
                                                            onAction="#incrementGuests"
                                                            styleClass="roundBtnMini"/>
                                                </HBox>
                                                <Separator />
                                                <Label text="Above 10 years are all considered as adults"
                                                       wrapText="true"
                                                       textAlignment="CENTER"
                                                       styleClass="helperNoteMini"/>
                                                <Button text="Done"
                                                        onAction="#closeGuests"
                                                        styleClass="doneBtnMini"/>
                                            </VBox>
                                        </StackPane>
                                    </StackPane>

                                    <!-- Search button -->
                                    <Button text="Search"
                                            fx:id="searchButton"
                                            onAction="#handleSearch"
                                            styleClass="searchCTA"
                                            prefHeight="72"/>
                                </HBox>

                                <!-- Results summary + sort (below search) -->
                                <HBox alignment="CENTER_LEFT" spacing="24" styleClass="propertiesRow">
                                    <Label fx:id="propertiesCountLabel" text="Loading properties..." styleClass="propertiesCount"/>
                                    <Pane HBox.hgrow="ALWAYS"/>
                                    <ComboBox fx:id="sortBox"
                                              promptText="Popularity"
                                              styleClass="sortSelect">
                                        <items>
                                            <FXCollections fx:factory="observableArrayList">
                                                <String fx:value="Popularity"/>
                                                <String fx:value="Price: Low to High"/>
                                                <String fx:value="Price: High to Low"/>
                                            </FXCollections>
                                        </items>
                                    </ComboBox>
                                </HBox>

                                <!-- Hotels list -->
                                <VBox fx:id="hotelsList" spacing="18" styleClass="hotelsList" maxWidth="Infinity"/>
                            </VBox>
                        </StackPane>
                    </VBox>
                </StackPane>
            </content>
        </ScrollPane>

        <!-- Fixed action buttons -->
        <VBox alignment="TOP_LEFT"
              spacing="12"
              StackPane.alignment="TOP_LEFT"
              pickOnBounds="false">
            <StackPane.margin>
                <Insets top="18" right="0" bottom="0" left="18"/>
            </StackPane.margin>

            <Button onAction="#goBack"
                    styleClass="pageReloadBtn"
                    maxWidth="160">
                <graphic>
                    <HBox alignment="CENTER" spacing="6">
                        <SVGPath styleClass="reloadIcon"
                                 content="M10 6l-3 3 3 3M6 9h10a3 3 0 0 1 0 6h-2"/>
                        <Label text="Back" styleClass="reloadLabel"/>
                    </HBox>
                </graphic>
            </Button>
        </VBox>

        <VBox alignment="TOP_RIGHT"
              spacing="12"
              StackPane.alignment="TOP_RIGHT"
              pickOnBounds="false">
            <StackPane.margin>
                <Insets top="18" right="18" bottom="0" left="0"/>
            </StackPane.margin>

            <Button onAction="#reloadHotels"
                    styleClass="pageReloadBtn"
                    maxWidth="160">
                <graphic>
                    <HBox alignment="CENTER" spacing="6">
                        <SVGPath styleClass="reloadIcon"
                                 content="M12 5v4l3-3m-6 0 3 3V5a7 7 0 1 1-7 7h2a5 5 0 1 0 5-5z"/>
                        <Label text="Reload" styleClass="reloadLabel"/>
                    </HBox>
                </graphic>
            </Button>
        </VBox>
    </children>
</StackPane>
